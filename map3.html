<!DOCTYPE html>
<html>
<head>
  <title>Time2Go</title>
  <!-- <script type ="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> -->
  <!-- <script type ="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARcbouYh7djP2yP-gdGqNpk4PW61B8E2E&callback=initialize"></script> -->
  <!-- <script type ="text/javascript" src="./map_directions.js"></script> -->
  <link rel="stylesheet" type="text/css" href="stylesheet.css"></sctipt>

</head>
<body>

<h1>Time2Go</h1>
  <br />

<div>
  <!-- add in IP/cell tower auto detect -->
  <input id="origin" type="text" placeholder="Where ya at?" value="General Assembly, Washington, DC">
</div>
<br />

<div>
  <input id="destination" type="text" placeholder="Where to?" value="Bethesda, MD">
  <input id="zoom-to-area" type="button" value="Let's go">
</div>
<br />


<!-- take this section out and replace with onclicks for divs -->
<select id="mode" onchange="displayDirections();">
  <option value="DRIVING">drive</option>
  <option value="WALKING">walk</option>
  <option value="BICYCLING">bike</option>
  <option value="TRANSIT">transit ride</option>
</select>


<div id="walk" value="WALKING">Walk</div>
<div value="BICYCLING" id="option">Bike</div>
<div value="BICYCLING" id="option">Bikeshare</div>
<div value="DRIVING" id="option">Drive</div>
<div value="TRANSIT" id="option">Rideshare</div>

<!-- <div id="right-panel"></div> -->
<div id="map" style="float:left; width:70%; height:100%"></div>




    <script>
      var map;
      function initMap() {

        // map style from Adam Krogh, https://snazzymaps.com/style/2/midnight-commander.

        var mapStyle = [{"featureType":"all","stylers":[{"saturation":0},{"hue":"#e7ecf0"}]},{"featureType":"road","stylers":[{"saturation":-70}]},{"featureType":"transit","stylers":[{"visibility":"off"}]},{"featureType":"poi","stylers":[{"visibility":"off"}]},{"featureType":"water","stylers":[{"visibility":"simplified"},{"saturation":-60}]}
          ]

        // Constructor creates a new map - only center and zoom are required.
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 38.889839, lng: -77.036042},
          zoom: 13,
          styles: mapStyle,
          mapTypeControl: false
        });
      }

      document.getElementById('origin').addEventListener('click', function() {
          zoomToArea();
        });
        document.getElementById('walk').addEventListener('click', function() {
              modeOptionStyle();
          });

        function modeOptionStyle(){
          console.log("div clicked")
        };

        function zoomToArea() {
        // Initialize the geocoder.
        var geocoder = new google.maps.Geocoder();
        // Get the address or place that the user entered.
        var address = document.getElementById('origin').value;
        // Make sure the address isn't blank.
        if (address == '') {
          window.alert("Please submit an address. Currently you're going nowhere (directionally-speaking, not in life)");
        } else {
          // Geocode the address/area entered to get the center. Then, center the map
          // on it and zoom in
          geocoder.geocode(
            { address: address},
            function(results, status) {
              if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                map.setZoom(15);
              } else {
                window.alert('We could not find that location - try entering a more' +
                    ' specific place.');
              }
            });
          }
        }




        function displayDirections(origin) {
          var directionsService = new google.maps.DirectionsService;
          // Get the destination address from the user entered value.
          var originAddress =
            document.getElementById('origin').value;
          var destinationAddress =
              document.getElementById('destination').value;
              console.log("origin: " + originAddress + "destination: " + destinationAddress)

          // Get mode again from the user entered value.
          var mode = document.getElementById('mode').value;
            console.log("console log of mode: " + mode)

          var strokeColorByMode = ''

            if (mode === "DRIVING"){
              strokeColorByMode = 'green'
            }
            else if (mode === "WALKING") {
              strokeColorByMode = 'blue'
            }
            else if (mode === "TRANSIT") {
              strokeColorByMode = 'red'
            }
            else {strokeColorByMode = 'yellow'}

          directionsService.route({
            // The origin is the passed in marker's position.
            origin: originAddress,
            // The destination is user entered address.
            destination: destinationAddress,
            travelMode: google.maps.TravelMode[mode]
            },
          function(response, status) {
            if (status === google.maps.DirectionsStatus.OK) {
              var directionsDisplay = new google.maps.DirectionsRenderer({
                map: map,
                directions: response,
                draggable: true,
                polylineOptions: {
                  strokeColor: strokeColorByMode
                }
              });
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }

        function calculateAndDisplayRoute(directionsService, directionsDisplay) {
                var start = document.getElementById('origin').value;
                var end = document.getElementById('destination').value;
                directionsService.route({
                  origin: start,
                  destination: end,
                  travelMode: 'DRIVING'
                }, function(response, status) {
                  if (status === 'OK') {
                    directionsDisplay.setDirections(response);
                  } else {
                    window.alert('Directions request failed due to ' + status);
                  }
                });
              }



    </script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARcbouYh7djP2yP-gdGqNpk4PW61B8E2E&v=3&callback=initMap">
    </script>


</body>
</html>
