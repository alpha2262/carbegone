<!DOCTYPE html>
<html>
<head>
  <title>Time2Go</title>
  <!-- <script type ="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> -->
  <!-- <script type ="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARcbouYh7djP2yP-gdGqNpk4PW61B8E2E&callback=initialize"></script> -->
  <!-- <script type ="text/javascript" src="./map_directions.js"></script> -->
  <!-- Compiled and minified CSS -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="stylesheet.css"></sctipt>

</head>
<body>

<h1>Time2Go</h1>

<div>
  <!-- add in IP/cell tower auto detect -->
  <input id="origin" type="text" placeholder="Where ya at?" value="General Assembly, Washington, DC">
</div>

<div>
  <input id="destination" type="text" placeholder="Where to?" value="Bethesda, MD">
  <!-- <input id="mapit" type="button" class="waves-effect waves-light btn" value="Let's go"> -->
</div>

<div>
  <ul>
    <a id="walk!" class="btn-floating red"><i class="material-icons">directions_walk</i></a>
    <a id="bike!" class="btn-floating yellow darken-1"><i class="material-icons">motorcycle</i></a>
    <a id="bikeshare!" class="btn-floating orange"><i class="material-icons">directions_bike</i></a>
    <a id="metro!" class="btn-floating green"><i class="material-icons">train</i></a>
    <a id="uber!" class="btn-floating blue"><i class="material-icons">event_seat</i></a>
    <a id="drive!" class="btn-floating purple"><i class="material-icons">drive_eta</i></a>
  </ul>
</div>

<!-- <div id="right-panel"></div> -->
<div id="map" style="float:left; width:70%; height:100%"></div>




    <script>
      var map;
      function initMap() {

        // map style from Adam Krogh, https://snazzymaps.com/style/2/midnight-commander.

        var mapStyle = [{"featureType":"all","stylers":[{"saturation":0},{"hue":"#e7ecf0"}]},{"featureType":"road","stylers":[{"saturation":-70}]},{"featureType":"transit","stylers":[{"visibility":"off"}]},{"featureType":"poi","stylers":[{"visibility":"off"}]},{"featureType":"water","stylers":[{"visibility":"simplified"},{"saturation":-60}]}
          ]

        // Constructor creates a new map - only center and zoom are required.
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 38.889839, lng: -77.036042},
          zoom: 13,
          styles: mapStyle,
          mapTypeControl: false
        });
      }

      // document.getElementById('mapit').addEventListener('click', function() {
      //     displayDirections();
      //   });
        document.getElementById('walk!').addEventListener('click', function() {
              var mode = "WALKING"
              displayDirections(origin, mode);
              console.log(mode + " selected")
        });
        document.getElementById('bike!').addEventListener('click', function() {
              var mode = "BICYCLING"
              displayDirections(origin, mode);
              console.log(mode + " selected")
        });
        document.getElementById('bikeshare!').addEventListener('click', function() {
              var mode = "BICYCLING"
              displayDirections(origin, mode);
              console.log(mode + " selected")
        });
        document.getElementById('metro!').addEventListener('click', function() {
              var mode = "TRANSIT"
              displayDirections(origin, mode);
              console.log(mode + " selected")
        });
        document.getElementById('uber!').addEventListener('click', function() {
              var mode = "DRIVING"
              displayDirections(origin, mode);
              console.log(mode + " selected")
        });
        document.getElementById('drive!').addEventListener('click', function() {
              var mode = "DRIVING"
              displayDirections(origin, mode);
              console.log(mode + " selected")
        });


        function displayDirections(origin, mode) {
          var directionsService = new google.maps.DirectionsService;
          // Get the destination address from the user entered value.
          var originAddress =
            document.getElementById('origin').value;
          var destinationAddress =
              document.getElementById('destination').value;
              console.log("origin: " + originAddress + "destination: " + destinationAddress)

          // Get mode again from the user entered value.
          // var mode = document.getElementById('mode').value;
            console.log("console log of mode: " + mode)

          var strokeColorByMode = ''

            if (mode === "DRIVING"){
              strokeColorByMode = 'purple'
            }
            else if (mode === "WALKING") {
              strokeColorByMode = 'red'
            }
            else if (mode === "TRANSIT") {
              strokeColorByMode = 'green'
            }
            else {strokeColorByMode = 'orange'}

          directionsService.route({
            // The origin is the passed in marker's position.
            origin: originAddress,
            // The destination is user entered address.
            destination: destinationAddress,
            travelMode: google.maps.TravelMode[mode]
            },
          function(response, status) {
            if (status === google.maps.DirectionsStatus.OK) {
              var directionsDisplay = new google.maps.DirectionsRenderer({
                map: map,
                directions: response,
                draggable: true,
                polylineOptions: {
                  strokeColor: strokeColorByMode
                }
              });
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }

        function calculateAndDisplayRoute(directionsService, directionsDisplay) {
                var start = document.getElementById('origin').value;
                var end = document.getElementById('destination').value;
                directionsService.route({
                  origin: start,
                  destination: end,
                  travelMode: 'DRIVING'
                }, function(response, status) {
                  if (status === 'OK') {
                    directionsDisplay.setDirections(response);
                  } else {
                    window.alert('Directions request failed due to ' + status);
                  }
                });
              }



    </script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARcbouYh7djP2yP-gdGqNpk4PW61B8E2E&v=3&callback=initMap">
    </script>


</body>
</html>
